# 变更说明（美化与主题开关）

本次改动聚焦前端 UI 美化与主题切换，业务逻辑保持不变：

1. 引入全局主题样式 `src/assets/theme.css`，定义明/暗两套 CSS 变量（背景、文字、边框、卡片、表格、阴影、圆角等），统一页面基底、卡片、导航、表格的风格。
2. 在 Dashboard 顶栏增加暗模式开关，记忆用户选择到 localStorage，并通过 `data-theme` 应用到全局，重新调整顶栏/页脚/侧栏配色与高度，避免多余滚动条。
3. 规格参数等列表页面轻量美化：新增工具栏、卡片包裹的表格区域和标题；表格开启边框与斑马纹，分页和内容保持在卡片内部；局部样式与全局主题变量协同。
4. 补充表格、侧边栏在暗色模式下的背景与文字适配，避免明暗混搭导致的对比度问题。

注意：未改动任何接口或业务流程，均为 UI 样式与主题切换相关。需前端重新编译预览效果。

# 追加改动（统一页面框架与间距）

- 品牌、分类、属性分组等页面改为与规格参数一致的“双层卡片”布局：顶部工具栏（操作/筛选）+ 表格/树形卡片，按钮统一 plain 风格，表格启用边框斑马纹。
- 分类树、属性分组等列表放入 `content-card`，顶层使用 `page-container`，全局顶部间距收紧（page-container padding 调整），靠近导航条避免留白过大。

# 本次调整（导航折叠与用户详情美化）

- 重做侧边栏顶部区域：增加品牌标识，折叠按钮改为圆角悬浮样式并带提示文案，位置贴近右侧，亮/暗色主题下都保持对比度和阴影。
- 用户详情页增加标题描述和卡片包裹的表单，字段容器使用主题边框与背景，在暗色模式下提升可读性和层次感。

# 本次修改（会员等级展示与路由）
- services 聚合与根模块增加 service-member 模块，member 服务补充 Mapper 查询全部等级、Service/Controller 列表接口并加入 Nacos 注册注解，网关 application-route.yaml 新增 /api/member/** 转发配置。
- 前端新增 src/view/member/member-level.vue，使用 <script setup> 调用 /api/member/level/list 渲染会员等级表格，展示成长值门槛、默认等级、免邮门槛、评价成长值、特权标签与备注，附刷新按钮和默认等级标记。
- 路由与菜单对接：router.js 添加 /dashboard/member/level 路由映射新页面，Dashboard 左侧“会员等级”菜单指向新路径，确保导航可达。
# 本次修改（会员等级新增与编辑）
- 会员等级页移除刷新按钮，新增“新增等级”入口并在表格行加入“编辑”按钮，提供弹窗表单（名称、成长值、默认等级、免邮/评价成长值、特权开关、备注），提交后自动刷新列表。
- 会员等级接口新增 POST/PUT 写入能力，添加参数校验，沿用 service-member 现有 Mapper；网关路径保持 /api/member/level 对接前端。
- 导航体验优化：会员等级路由写入导航映射，面包屑显示“首页/会员管理/会员等级”，刷新页面时左侧会员菜单保持展开与选中。

# 本次修改（分类树暗色适配与登录页焕新）

- 分类维护页移除无效复选框，重绘树形容器的边框、填充与阴影，暗色模式下也保持一致的层次感。
- 登录页采用左右分栏布局，左侧展示业务亮点和指标，右侧卡片承载账号表单，输入框带前缀图标与统一的间距样式。
- 登录页挂载时读取 sanguimall-theme 并设置 data-theme，背景、提示卡片与输入框依托 CSS 变量响应亮暗主题，保证与控制台一致。
# 本次修改（会员列表与 OSS 头像）

- service-member 模块新增会员管理接口：补充 MemberPageQuery/MemberSaveQuery/VO，添加 UmsMemberService 及实现、Bcrypt 加密配置、Mapper 条件查询与用户名校验，以及 UmsMemberController 暴露列表/详情/新增/编辑 API，所有写操作沿用 status 字段控制删除逻辑。
- 前端新增 src/view/member/member-list.vue，包含搜索筛选、分页表格、会员表单与 OSS 头像上传/预览/复制逻辑，自动拉取会员等级与头像签名 URL，密码按需加密。
- router.js 与 DashboardView.vue 新增 /dashboard/member/list 路由和菜单/面包屑映射，确保会员列表入口可直接访问并保持选中态。
# 本次修改（会员列表细节与等级约束）

- member 服务的会员列表 SQL 调整为按 id 升序，并在返回 VO 中增加 createTimeText，采用上海时区格式化为 yyyy-MM-dd-HH-mm-SSS，确保前端按中国时间展示；新增默认等级数量校验接口（mapper/service/controller）以保证任意时刻仅有一个默认等级。
- 会员等级前端在有默认等级存在时禁用其他行/新增的“默认等级”开关，仅允许当前默认等级编辑；友好提示信息沿用后端校验返回。
- 会员列表页优化顶部工具条布局，让按钮与查询表单底部对齐；新增来源列（后台创建/用户注册）并移除表单里的来源输入，新增默认值；注册时间列使用 createTimeText；source_type 默认 0，并在表格展示来源。
# 本次调整（会员列表布局与签名展示）

- 调整 /dashboard/member/list 工具条布局，让搜索表单紧贴刷新按钮，按钮与输入保持同一行并减少右侧留白，整体更协调。
- 会员列表增加“个性签名”列支持两行展示，同时仍保留编辑弹窗；便于直接查看。

# 本次修改（会员积分变化与等级联动）

- service-member 模块新增积分/成长值历史分页接口：补充 ChangeHistoryPageQuery、VO、Service/Controller 以及 Mapper 联表 SQL，返回会员账号、变化值、来源、备注与格式化时间，成长值变动后按 ums_member_level.growth_point 自动推算等级（负值回落默认等级）。
- 编辑会员放宽积分/成长值限制，UmsMemberServiceImpl 在更新成功后写入 ums_integration_change_history 与 ums_growth_change_history，备注格式与示例一致、source_type=1，并在成长值变化时自动同步会员等级。
- 前端新增 “会员管理/积分变化” 页面（member-points-history.vue），通过 tabs 同屏展示积分与成长值记录，支持关键字搜索、分页和来源/备注/时间展示，菜单、路由、面包屑同步新增入口。
- 会员列表弹窗的积分/成长值字段改为“增减”操作条，输入调整额度后点击应用再统一保存，提示成长值变化会驱动等级联动，避免误触。

# Hotfix（会员列表查询 & 积分排序）

- 会员列表接口容错：UmsMemberServiceImpl 在分页查询时兜底空集合，避免 MyBatis 返回 null 时触发 NPE，确保页面可正常获取数据。
- 积分/成长值历史 SQL 改为按主键递增排序（id ASC），与表记录顺序一致，展示效果和用户期望一致。 

# 本次优化（会员创建/编辑体验）

- 新增会员弹窗恢复为直接填写积分、成长值（默认 0），便于初始化；只有编辑时才展示“增/减”调整组件并保留生成记录的机制。
- 已有会员的等级选择框改为禁用状态并提示“随成长值自动变化”，确保等级只通过成长值变动自动维护。
